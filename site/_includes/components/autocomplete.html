<article id="autocomplete">
    <h2>
        Autocomplete
    </h2>
    <p>
        Check the
        <a href="{{ site.baseurl }}/{{ site.chico_path_api_doc }}{{ chico_current_version }}/{{ chico_current_platform }}/ch.autocomplete/">API documentation</a>
        for this component.
    </p>
    <div class="component-example">
        <form class="ch-form" method="get" action="http://www.mercadolibre.com.ar/jm/search">
            <fieldset>
                <div class="ch-form-row">
                    <label for="dm_ac">Autocomplete:</label>
                    <input id="dm_ac" name="as_word" type="text" placeholder="iPhone" />
                    <p class="ch-form-hint">This is working with the Mercado Libre API</p>
                </div>
            </fieldset>

            <div class="ch-form-actions">
                <input class="ch-btn" id="dm_ac_sbt" name="dm_ac_sbt" type="submit" />
            </div>
        </form>
    </div>
{% highlight html %}
<form class="ch-form" method="get" action="http://www.mercadolibre.com.ar/jm/search">
    <input id="dm_ac" name="dm_ac" type="text" placeholder="iPhone" />
    <input class="ch-btn" id="dm_ac_sbt" name="dm_ac_sbt" type="submit" />
</form>
{% endhighlight %}
{% highlight javascript %}
function parseResults(results) {
    var data = [];
    if (results[2].suggested_queries !== undefined) {
        results[2].suggested_queries.forEach(function (e, i) {
            data.push(e.q);
        });
        // Show suggestions
        autocomplete.suggest(data);
    }
}

var autocomplete = new ch.Autocomplete({% if chico_current_version == site.chico_version_1x %}$('#dm_ac'){% endif %}{% if chico_current_version == site.chico_version_2x %}ch('#dm_ac')[0]{% endif %})
    .on('type', function (userInput) {
        {% if chico_current_version == site.chico_version_1x %}$.ajax({
            'url': 'http://suggestgz.mlapps.com/sites/MLA/autosuggest?q=' + userInput + '&v=1&callback=parseResults',
            'dataType': 'jsonp',
            'cache': false,
            'global': true,
            'context': window,
            'jsonp': 'parseResults',
            'crossDomain': true
        });{% endif %}{% if chico_current_version == site.chico_version_2x %}tiny.jsonp('http://suggestgz.mlapps.com/sites/MLA/autosuggest?q=' + userInput + '&v=1', {
            'name': 'dm_ac_sbt',
            'success': parseResults,
            'error': function (err) {
                autocomplete.suggest([]);
            }
        });{% endif %}
    });
{% endhighlight %}
    <script>
        function parseResults(results) {
            var data = [];
            if (results[2].suggested_queries !== undefined) {
                results[2].suggested_queries.forEach(function (e, i) {
                    data.push(e.q);
                });
                // Show suggestions
                autocomplete.suggest(data);
            }
        }

        var autocomplete;

        document.addEventListener('DOMContentLoaded', function (e) {
            autocomplete = new ch.Autocomplete({% if chico_current_version == site.chico_version_1x %}$('#dm_ac'){% endif %}{% if chico_current_version == site.chico_version_2x %}ch('#dm_ac')[0]{% endif %})
                .on('type', function (userInput) {
                    {% if chico_current_version == site.chico_version_1x %}
                    $.ajax({
                        'url': 'http://suggestgz.mlapps.com/sites/MLA/autosuggest?q=' + userInput + '&v=1&callback=parseResults',
                        'dataType': 'jsonp',
                        'cache': false,
                        'global': true,
                        'context': window,
                        'jsonp': 'parseResults',
                        'crossDomain': true
                    });
                    {% endif %}
                    {% if chico_current_version == site.chico_version_2x %}
                    tiny.jsonp('http://suggestgz.mlapps.com/sites/MLA/autosuggest?q=' + userInput + '&v=1', {
                        'name': 'dm_ac_sbt',
                        'success': parseResults,
                        'error': function (err) {
                            autocomplete.suggest([]);
                        }
                    });
                    {% endif %}
                });
        });
    </script>
</article>
